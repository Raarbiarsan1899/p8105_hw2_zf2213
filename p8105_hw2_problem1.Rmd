---
title: "P8105 Homework 2 Problem 1"
author: "Zanis Fang"
date: "9/26/2018"
output:
  html_document:
    toc: TRUE
    toc_float: TRUE
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

### Data loading and cleaning

```{r load_clean, message = FALSE}
# load data
raw_nyc_transit <- read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")

# data cleaning
nyc_transit <- raw_nyc_transit %>% 
               janitor::clean_names() %>% 
               #select needed rows
               select(line:ada, -exit_only, -staffing, -staff_hours)  %>% 
	             #recode entry to logic
               mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))

```

Each row represents an entrance. The dataframe contains line names, station names, station location, connected train routes, type of entrance, entry or exit, has vending or not, ADA compliant or not. Use "janitor::clean_names" to clean the column names, select indicated columns, and change entry to TRUE or FALSE. There are `r dim(nyc_transit)[1]` rows, `r dim(nyc_transit)[2]` columns. The data is not tidy. The route 1-11 are actually data rather than variable. Besides, data type should be TRUE or FALSE instead of YES or NO. 

**Q1. How many distinct stations are there? Note that stations are identified both by name and by line (e.g. 125th St A/B/C/D; 125st 1; 125st 4/5); the distinct function may be useful here.**

```{r distinct_station}
#unique station with ADA compliant information
station_ada <- distinct(nyc_transit, line, station_name, ada)
```

There are `r nrow(station_ada)` distinct stations.

**Q2. How many stations are ADA compliant?**

There are `r sum(station_ada$ada)` stations which are ADA compliant.

**Q3. What proportion of station entrances / exits without vending allow entrance?**

The proportion of station entrances/exits without vending is `r sum(nyc_transit$vending == "NO") / nrow(nyc_transit)`.

### Reform table

```{r reform}
nyc_transit <- gather(nyc_transit,
										  key = "route_number",
											value = "route_name",
											route1:route11)

# distinct station serve A train with ADA information
station_train_a <- nyc_transit %>%
	                 distinct(line, station_name, route_name, ada) %>% 
	                 filter(route_name == "A")


```

There are `r nrow(station_train_a)` stations serve the A train, among which `r sum(station_train_a$ada)` are ADA compliant.



