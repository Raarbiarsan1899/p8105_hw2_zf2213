---
title: "P8105 Homwork 2 Problem 2"
author: "Zanis Fang"
date: "9/26/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

**Read and clean the Mr. Trash Wheel sheet**

```{r load}
#load data
trash_wheel <- readxl::read_xlsx("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
																 sheet = 1,
																 range = readxl::cell_cols("A:N"))

trash_wheel <- trash_wheel %>% 
	             janitor::clean_names() %>% 
	             filter(!is.na(date)) %>% 
	             mutate(sports_balls = sports_balls %>% round(0) %>% as.integer())

```

**Read and clean precipitation data from 2016 and 2017**

```{r precipitation}

# define a function to load data and clean data
prcp_load_clean <- function(wh_year) {
	           
	                 readxl::read_xlsx("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
		                      					sheet = paste(wh_year, "Precipitation"),
												      			range = "A2:B14"
														      	) %>%
		
		               janitor::clean_names() %>% 
	          	     filter(!is.na(total)) %>% 
		               mutate(year = wh_year)
	       
}

prcp_data <- rbind(prcp_load_clean(2016), prcp_load_clean(2017))
prcp_data$month <- month.name[prcp_data$month]



```

In Mr. Trash Wheel data, it describes the amount of trash each dumpster colloects. There are `r nrow(trash_wheel)` individual dumpsters. In each dumpster, it categorizes the kind of trash, like "plastic bags", "cigarette butts", etc. For precipitation data in 2017, there are in total `r sum(subset(prcp_data, year == 2017, select = total))` inch precipitation. The median number of sports balls in a dumpster in 2016 is `r median(subset(trash_wheel, year == 2016, select = sports_balls)[[1]])`.